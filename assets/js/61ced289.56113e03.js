"use strict";(self.webpackChunkjohnycho_dev=self.webpackChunkjohnycho_dev||[]).push([[675],{9059:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>l,contentTitle:()=>s,default:()=>p,frontMatter:()=>t,metadata:()=>i,toc:()=>d});var i=r(9442),o=r(4848),c=r(8453);const t={slug:"spring-cloud-config-decrypt",title:"Spring Cloud Config\uc758 \ubcf5\ud638\ud654 \uc2e4\ud328 \ucc98\ub9ac \uacfc\uc815 \u2014 {cipher}...\uac00 invalid.*\ub85c \ubc14\ub00c\ub294 \uc774\uc720",authors:["johnycho"],tags:["spring"]},s="Spring Cloud Config\uc758 \ubcf5\ud638\ud654 \uc2e4\ud328 \ucc98\ub9ac \uacfc\uc815 \u2014 cipher...\uac00 invalid.*\ub85c \ubc14\ub00c\ub294 \uc774\uc720",l={authorsImageUrls:[void 0]},d=[{value:"\uc554\ud638\ud654\ub41c \uc124\uc815\uc774 \uc11c\ubc84\uc5d0 \uc804\ub2ec\ub418\ub294 \uad6c\uc870",id:"\uc554\ud638\ud654\ub41c-\uc124\uc815\uc774-\uc11c\ubc84\uc5d0-\uc804\ub2ec\ub418\ub294-\uad6c\uc870",level:2},{value:"\ubcf5\ud638\ud654 \uc2e4\ud328 \uc2dc <code>invalid.*</code> \ud0a4\ub85c \ubb34\ud6a8\ud654 \ucc98\ub9ac",id:"\ubcf5\ud638\ud654-\uc2e4\ud328-\uc2dc-invalid-\ud0a4\ub85c-\ubb34\ud6a8\ud654-\ucc98\ub9ac",level:2},{value:"\ud074\ub77c\uc774\uc5b8\ud2b8\uc5d0\uc11c <code>invalid.*</code> \uac00 \ubb34\uc2dc\ub418\ub294 \uc774\uc720",id:"\ud074\ub77c\uc774\uc5b8\ud2b8\uc5d0\uc11c-invalid-\uac00-\ubb34\uc2dc\ub418\ub294-\uc774\uc720",level:2}];function h(n){const e={br:"br",code:"code",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,c.R)(),...n.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("br",{}),"\n",(0,o.jsx)("br",{}),"\n",(0,o.jsxs)(e.p,{children:["Spring Cloud Config Server\ub97c \uc4f0\ub2e4 \ubcf4\uba74,\n\uc554\ud638\ud654\ub41c \uc124\uc815\uac12 ",(0,o.jsx)(e.code,{children:"{cipher}..."}),"\uac00 \ubcf5\ud638\ud654\uc5d0 \uc2e4\ud328\ud558\uba74\uc11c ",(0,o.jsx)(e.code,{children:"invalid.my.secret"})," \ud615\ud0dc\ub85c \ub178\ucd9c\ub418\uace0,\n\uacb0\uad6d \ub85c\uceec ",(0,o.jsx)(e.code,{children:"application.properties"}),"\uc758 \uac12\uc774 \uc801\uc6a9\ub418\ub294 \uacbd\uc6b0\uac00 \uc788\uc2b5\ub2c8\ub2e4."]}),"\n",(0,o.jsx)(e.p,{children:"\uc624\ub298\uc740 \uadf8 \ub0b4\ubd80 \uba54\ucee4\ub2c8\uc998\uc744 \ucf54\uc5b4 \ucf54\ub4dc \ub808\ubca8\uc5d0\uc11c\uae4c\uc9c0 \ub72f\uc5b4\ubcf4\ub824 \ud569\ub2c8\ub2e4."}),"\n",(0,o.jsx)(e.h2,{id:"\uc554\ud638\ud654\ub41c-\uc124\uc815\uc774-\uc11c\ubc84\uc5d0-\uc804\ub2ec\ub418\ub294-\uad6c\uc870",children:"\uc554\ud638\ud654\ub41c \uc124\uc815\uc774 \uc11c\ubc84\uc5d0 \uc804\ub2ec\ub418\ub294 \uad6c\uc870"}),"\n",(0,o.jsxs)(e.p,{children:["Config Server\ub294 Git, FileSystem, Vault \ub4f1\uc5d0\uc11c \uc124\uc815 \ud30c\uc77c\uc744 \uc77d\uace0,\n",(0,o.jsx)(e.code,{children:"EnvironmentRepository.findOne()"}),"\uc744 \ud1b5\ud574 \ud074\ub77c\uc774\uc5b8\ud2b8\uc5d0 ",(0,o.jsx)(e.code,{children:"Environment"})," \uac1d\uccb4(JSON)\ub97c \ubc18\ud658\ud569\ub2c8\ub2e4."]}),"\n",(0,o.jsxs)(e.p,{children:["\uc774\ub54c \uc124\uc815\uac12 \uc911 ",(0,o.jsx)(e.code,{children:"{cipher}..."}),"\ub85c \uc2dc\uc791\ud558\ub294 \ud56d\ubaa9\uc774 \uc788\uc73c\uba74",(0,o.jsx)(e.br,{}),"\n",(0,o.jsx)(e.code,{children:"EnvironmentController"})," \u2192 ",(0,o.jsx)(e.code,{children:"EnvironmentRepository"})," \u2192 ",(0,o.jsx)(e.code,{children:"EnvironmentEncryptor.decrypt()"}),"\n\ub2e8\uacc4\ub97c \uac70\uce58\uba70 \ubcf5\ud638\ud654\ub97c \uc2dc\ub3c4\ud569\ub2c8\ub2e4."]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-java",children:'// EnvironmentEncryptorEnvironmentRepository.java\n@Override\npublic Environment findOne(String name, String profiles, String label, boolean includeOrigin) {\n    Environment environment = this.delegate.findOne(name, profiles, label, includeOrigin);\n    if (this.environmentEncryptors != null) {\n        for (EnvironmentEncryptor environmentEncryptor : environmentEncryptors) {\n            environment = environmentEncryptor.decrypt(environment);\n        }\n    }\n    if (!this.overrides.isEmpty()) {\n        environment.addFirst(new PropertySource("overrides", getOverridesMap(includeOrigin)));\n    }\n    return environment;\n}\n'})}),"\n",(0,o.jsxs)(e.p,{children:["\uae30\ubcf8\uc801\uc73c\ub85c \uc544\ub798 \ub450 \uac1c\uc758 ",(0,o.jsx)(e.code,{children:"EnvironmentEncryptor"}),"\uac00 \uc874\uc7ac\ud569\ub2c8\ub2e4."]}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.code,{children:"CipherEnvironmentEncryptor"})," (\uae30\ubcf8 RSA/Key \uae30\ubc18 \ubcf5\ud638\ud654)"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.code,{children:"VaultEnvironmentEncryptor"})," (HashiCorp Vault \uc5f0\ub3d9 \uc2dc)"]}),"\n"]}),"\n",(0,o.jsxs)(e.h2,{id:"\ubcf5\ud638\ud654-\uc2e4\ud328-\uc2dc-invalid-\ud0a4\ub85c-\ubb34\ud6a8\ud654-\ucc98\ub9ac",children:["\ubcf5\ud638\ud654 \uc2e4\ud328 \uc2dc ",(0,o.jsx)(e.code,{children:"invalid.*"})," \ud0a4\ub85c \ubb34\ud6a8\ud654 \ucc98\ub9ac"]}),"\n",(0,o.jsxs)(e.p,{children:[(0,o.jsx)(e.code,{children:"CipherEnvironmentEncryptor.decrypt()"})," \ub0b4\ubd80\ub97c \ubcf4\uba74,\n\uac01 ",(0,o.jsx)(e.code,{children:"PropertySource"}),"\uc758 \ud0a4/\uac12\uc744 \uc21c\ud68c\ud558\uba70 ",(0,o.jsx)(e.code,{children:"{cipher}"})," \uc811\ub450\uc5b4\uac00 \ubd99\uc740 \ud56d\ubaa9\uc744 \ubcf5\ud638\ud654\ud569\ub2c8\ub2e4."]}),"\n",(0,o.jsxs)(e.p,{children:["\ubcf5\ud638\ud654 \uc911 \uc608\uc678(",(0,o.jsx)(e.code,{children:"EncryptionOperationNotPossibleException"}),")\uac00 \ubc1c\uc0dd\ud558\uba74 \ub2e4\uc74c\uacfc \uac19\uc774 \ucc98\ub9ac\ub429\ub2c8\ub2e4."]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-java",children:'// CipherEnvironmentEncryptor.decrypt() \ucf54\ub4dc \uc694\uc57d\ncatch (Exception e){\n    if(this.prefixInvalidProperties) {\n        value = "<n/a>";\n        name = "invalid." + name;\n    }\n    String message = "Cannot decrypt key: " + key + " (" + e.getClass() + ": " + e.getMessage() + ")";\n}\nmap.put(name, value);\n'})}),"\n",(0,o.jsxs)(e.p,{children:["\uc989, \uc6d0\ub798 \ud0a4 ",(0,o.jsx)(e.code,{children:"my.secret"})," \ub300\uc2e0 ",(0,o.jsx)(e.code,{children:"invalid.my.secret"}),"\uc774 \ucd94\uac00\ub429\ub2c8\ub2e4.",(0,o.jsx)(e.br,{}),"\n","\uc774\ub54c \uae30\uc874 ",(0,o.jsx)(e.code,{children:"my.secret"})," \ud0a4\ub294 \uc874\uc7ac\ud558\uc9c0 \uc54a\uc73c\ubbc0\ub85c, Config Client\ub294 \uc774 \uac12\uc744 \ubb34\uc2dc\ud558\uac8c \ub429\ub2c8\ub2e4."]}),"\n",(0,o.jsxs)(e.h2,{id:"\ud074\ub77c\uc774\uc5b8\ud2b8\uc5d0\uc11c-invalid-\uac00-\ubb34\uc2dc\ub418\ub294-\uc774\uc720",children:["\ud074\ub77c\uc774\uc5b8\ud2b8\uc5d0\uc11c ",(0,o.jsx)(e.code,{children:"invalid.*"})," \uac00 \ubb34\uc2dc\ub418\ub294 \uc774\uc720"]}),"\n",(0,o.jsxs)(e.p,{children:["Config Client\uac00 \uc11c\ubc84\ub85c\ubd80\ud130 \ubc1b\uc740 \uc124\uc815\uc744 ",(0,o.jsx)(e.code,{children:"Environment"}),"\ub85c \uba38\uc9c0\ud560 \ub54c,\n",(0,o.jsx)(e.code,{children:"PropertySourcesPropertyResolver"}),"\uac00 \uc21c\uc11c\ub300\ub85c ",(0,o.jsx)(e.code,{children:"PropertySource"}),"\ub97c \uc21c\ud68c\ud558\uba70 \uac12\uc744 \ucc3e\uc2b5\ub2c8\ub2e4."]}),"\n",(0,o.jsxs)(e.ol,{children:["\n",(0,o.jsxs)(e.li,{children:["\uba3c\uc800 ",(0,o.jsx)(e.code,{children:"configserver:*"})," ",(0,o.jsx)(e.code,{children:"PropertySource"}),"\ub97c \ud0d0\uc0c9"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.code,{children:"{cipher}"})," \ubcf5\ud638\ud654 \uc2e4\ud328 \u2192 ",(0,o.jsx)(e.code,{children:"invalid.my.secret"}),"\ub9cc \uc874\uc7ac"]}),"\n",(0,o.jsxs)(e.li,{children:["\ucc3e\uc9c0 \ubabb\ud558\uba74 \ub2e4\uc74c ",(0,o.jsx)(e.code,{children:"PropertySource"})," (\ub85c\uceec \ud30c\uc77c \ub4f1)\ub85c fall-through"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.code,{children:"application.properties"}),"\uc5d0\uc11c ",(0,o.jsx)(e.code,{children:"my.secret=localValue"})," \ubc1c\uacac \u2192 \ubc18\ud658 \u2705"]}),"\n"]}),"\n",(0,o.jsxs)(e.p,{children:["\uc989, ",(0,o.jsx)(e.code,{children:"invalid.*"})," \ud0a4\ub294 ",(0,o.jsx)("mark",{children:(0,o.jsx)(e.strong,{children:"\ub2e8\uc9c0 \uc2e4\ud328 \ud754\uc801\uc77c \ubfd0"})}),", ",(0,o.jsx)(e.code,{children:"Environment"}),"\uc5d0\uc11c\ub294 ",(0,o.jsx)("mark",{children:(0,o.jsx)(e.strong,{children:"\ucc38\uc870\ub418\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4."})})]}),"\n",(0,o.jsxs)(e.p,{children:["\uc774 \ub3d9\uc791\uc740 ",(0,o.jsx)(e.code,{children:"AbstractEnvironment"})," \ub0b4\ubd80\uc5d0\uc11c merge\ub420 \ub54c, \ub2e8\uc21c\ud788 ",(0,o.jsx)(e.code,{children:"PropertySource"})," \uc21c\uc11c\ub300\ub85c \ubd99\uae30 \ub54c\ubb38\uc5d0\n\ud2b9\ubcc4\ud55c \uc608\uc678\ucc98\ub9ac \uc5c6\uc774 ",(0,o.jsxs)("mark",{children:["\u201c\ub4a4\uc5d0 \uc624\ub294 ",(0,o.jsx)(e.code,{children:"PropertySource"}),"\uac00 \uc6b0\uc120\uad8c\uc744 \uac00\uc9c4\ub2e4\u201d"]}),"\ub294 \uc77c\ubc18 \uaddc\uce59\uc73c\ub85c \ud574\uacb0\ub429\ub2c8\ub2e4."]})]})}function p(n={}){const{wrapper:e}={...(0,c.R)(),...n.components};return e?(0,o.jsx)(e,{...n,children:(0,o.jsx)(h,{...n})}):h(n)}},8453:(n,e,r)=>{r.d(e,{R:()=>t,x:()=>s});var i=r(6540);const o={},c=i.createContext(o);function t(n){const e=i.useContext(c);return i.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function s(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(o):n.components||o:t(n.components),i.createElement(c.Provider,{value:e},n.children)}},9442:n=>{n.exports=JSON.parse('{"permalink":"/blog/spring-cloud-config-decrypt","source":"@site/blog/2025-04-07-spring-cloud-config-decrypt.mdx","title":"Spring Cloud Config\uc758 \ubcf5\ud638\ud654 \uc2e4\ud328 \ucc98\ub9ac \uacfc\uc815 \u2014 {cipher}...\uac00 invalid.*\ub85c \ubc14\ub00c\ub294 \uc774\uc720","description":"Spring Cloud Config Server\ub97c \uc4f0\ub2e4 \ubcf4\uba74,","date":"2025-04-07T00:00:00.000Z","tags":[{"inline":false,"label":"Spring","permalink":"/blog/tags/spring","description":"Spring tag description"}],"readingTime":3.145,"hasTruncateMarker":true,"authors":[{"name":"Johny Cho","title":"Back End Engineer @ NHN","url":"https://github.com/johnycho","page":{"permalink":"/blog/authors/johnycho"},"socials":{"github":"https://github.com/johnycho","instagram":"https://www.instagram.com/johny__cho","linkedin":"https://www.linkedin.com/in/johny-cho/"},"imageURL":"https://github.com/johnycho.png","key":"johnycho"}],"frontMatter":{"slug":"spring-cloud-config-decrypt","title":"Spring Cloud Config\uc758 \ubcf5\ud638\ud654 \uc2e4\ud328 \ucc98\ub9ac \uacfc\uc815 \u2014 {cipher}...\uac00 invalid.*\ub85c \ubc14\ub00c\ub294 \uc774\uc720","authors":["johnycho"],"tags":["spring"]},"unlisted":false,"prevItem":{"title":"Redis Spin Lock\uc5d0\uc11c Redisson \uae30\ubc18 \ubd84\uc0b0\ub77d\uc73c\ub85c \uac1c\uc120\ud558\uae30","permalink":"/blog/redis-distributed-lock"},"nextItem":{"title":"\uc138\ucee8\ub354\ub9ac \uc778\ub371\uc2a4\uc640 PK \uc778\ub371\uc2a4 \uac04 \ub370\ub4dc\ub77d, \uc65c \ubc1c\uc0dd\ud560\uae4c?","permalink":"/blog/index-deadlock"}}')}}]);